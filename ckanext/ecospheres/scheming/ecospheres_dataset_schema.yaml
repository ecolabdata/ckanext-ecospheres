tscheming_version: 2
dataset_type: dataset
about: Dataset schema for INSPIRE and DCAT data
about_url: https://github.com/ecolabdata/ckanext-ecospheres


# ----------------------------------------------------------------------------------------
# ---------------------------------- Onglets ---------------------------------------------
# ----------------------------------------------------------------------------------------

.tab_data: &tab_data
  fr: Accès aux données
  en: Data access

.tab_details: &tab_details
  fr: Détails
  en: Details

.tab_docs: &tab_docs
  fr: Documentation
  en: Documentation

.tab_contacts: &tab_contacts
  fr: Contacts et acteurs
  en: Relevant parties

.tab_catalog: &tab_catalog
  fr: Catalogage
  en: Record

# ----------------------------------------------------------------------------------------
# ---------------------------------- Variables communes ----------------------------------
# ----------------------------------------------------------------------------------------

# # ------------------------------------------------------------------------------------
# # ---------------------------------- JEU DE DONNEES ----------------------------------
# # ------------------------------------------------------------------------------------
# # -> dcat:Dataset

dataset_fields:

# NAME
# - sert à construire les URL de CKAN + gestion des doublons
# - pour les métadonnées INSPIRE, il s'agit de l'identifiant de la fiche
#   de métadonnées (et non celui du jeu de données)
# - pour les métadonnées DCAT, il est déduit de "identifier" ou, à
#   défaut, de "uri".
- field_name: name
  label: 
    fr: Identifiant sémantique CKAN
    en: Slug
  preset: dataset_slug
  value_type: literal
  
# URI
# - fournit l'URI du dcat:Dataset pour l'exposition DCAT
# - pour les métadonnées INSPIRE, il est déduit de "landing_page"
# - pour les métadonnées DCAT, l'URI d'origine est préservé
- field_name: uri
  label:
    fr: URI du jeu de données
    en: Dataset URI
  display_snippet: null
  value_type: uri

# IDENTIFIER
# > dct:identifier
# - pour les métadonnées INSPIRE, il s'agit ici de l'identifiant du
#   jeu de données et non de l'identifiant de la fiche de métadonnées
#   (cf. propriété "is_primary_topic_of")
- field_name: identifier
  rdf_path:
    - dct:identifier
    - xsd:string
  label:
    fr: Identifiant du jeu de données
    en: Dataset identifier
  display_snippet: null
  help_text: Identifiant du jeu de données dans le catalogue source.
  value_type: literal

# TITLE {*}
# > dct:title
# - pour les métadonnées INSPIRE, on utilisera le titre alternatif
#   si et seulement si le titre n'est pas renseigné
# - le champ "title" est utilisé pour l'affichage,
#   "title_translated" pour l'exposition.
- field_name: title
  alt_rdf_paths:
    - dct:title
  label: 
    fr: Titre
    en: Title
  preset: title
  help_text: Libellé du jeu de données.
  value_type: literal

- field_name: title_translated
  rdf_path:
    - dct:title
    - rdf:langString
  label: 
    en: Titre (translation)
    fr: Title (traduction)
  help_text: Libellé multilingue du jeu de données.
  preset: fluent_core_translated
  value_type: literal
  translatable_values: True

# NOTES {*}
# > dct:description
# - le champ "notes" est utilisé pour l'affichage,
#   "notes_translated" pour l'exposition.
- field_name: notes
  alt_rdf_paths:
    - dct:description
  label: 
    en: Description
    fr: Description
  help_text: Description du jeu de données.
  preset: markdown
  value_type: literal

- field_name: notes_translated
  rdf_path:
    - dct:description
    - rdf:langString
  label: 
    en: Description (translation)
    fr: Description (traduction)
  help_text: Description multilingue du jeu de données.
  preset: fluent_core_translated
  value_type: literal
  translatable_values: True

# OWNER_ORG
# - non affiché en tant que tel, non exposé en DCAT
# - identifiant de l'organisation CKAN à laquelle est rattaché
#   le jeu de données
- field_name: owner_org
  label:
    fr: Organisation
    en: Organization
  value_type: literal
  display_snippet: null

# # ------- Dates --------

# TEMPORAL [{}]
# > dct:temporal -> dct:PeriodOfTime
- field_name: temporal
  rdf_path:
    - dct:temporal
    - dct:PeriodOfTime
  label: 
    fr: Couverture temporelle
    en: Temporal coverage
  help_text: Périodes décrites par le jeu de données.
  value_type: node
  repeating_subfields:
    # START_DATE
    # > dcat:startDate
    - field_name: start_date
      rdf_path:
        - dcat:startDate
        - xsd:date
      preset: ecospheres_date_or_datetime
      label: 
        fr: Date de début
        en: Start date
      value_type: literal
    # END_DATE
    # > dcat:endDate
    - field_name: end_date
      rdf_path:
        - dcat:endDate
        - xsd:date
      preset: ecospheres_date_or_datetime
      label:
        fr: Date de fin
        en: End date
      value_type: literal

# MODIFIED
# > dct:modified
- field_name: modified
  rdf_path:
    - dct:modified
    - xsd:date
  label: 
    fr: Date de modification
    en: Modification date
  preset: ecospheres_date_or_datetime
  help_text: Date de dernière modification du jeu de données.
  value_type: literal

# CREATED
# > dct:created
- field_name: created
  rdf_path:
    - dct:created
    - xsd:date
  label:
    fr: Date de création
    en: Creation date
  preset: ecospheres_date_or_datetime
  help_text: Date de création du jeu de données.
  value_type: literal
  tab: *tab_details

# ISSUED
# > dct:issued
- field_name: issued
  rdf_path:
    - dct:issued
    - xsd:date
  label: 
    fr: Date de publication
    en: Release date
  preset: ecospheres_date_or_datetime
  help_text: Date de publication du jeu de données.
  value_type: literal
  tab: *tab_details

# # ------ Organisations ------

# CONTACT_POINT [{}]
# > dcat:contactPoint -> vcard:Kind
# - cf. "publisher" pour les détails sur le stockage et l'affichage
# - l'exposition DCAT est différente (objet de classe vcard:Kind et non
#   foaf:Agent, avec des propriétés équivalentes - même stockage - mais
#   qui portent d'autres noms)
- field_name: contact_point
  rdf_path:
    - dcat:contactPoint 
    - vcard:Kind
  label: 
    fr: Points de contact
    en: Contact point
  repeating_label: Point de contact
  help_text: Entité à contacter pour obtenir des informations sur les données.
  value_type: node
  tab: *tab_contacts
  repeating_subfields: &contact_fields
    # NAME {*}
    # > vcard:fn
    # [+ GeoDCAT-AP]
    # > vcard:fn
    - field_name: name
      rdf_path:
        - vcard:fn
        - rdf:langString
      label:
        fr: Nom
        en: Name
      preset: multilingual_text
      value_type: literal
      translatable_values: True
    # EMAIL
    # > vcard:hasEmail
    # [+ GeoDCAT-AP]
    - field_name: email
      rdf_path:
        - vcard:hasEmail
        - owl:Thing
      label:
        fr: Courriel
        en: Mail
      preset: ecospheres_email
      value_type: uri
    # PHONE
    # > vcard:hasTelephone
    # [+ GeoDCAT-AP]
    - field_name: phone
      rdf_path:
        - vcard:hasTelephone
        - owl:Thing
      label: 
        fr: Téléphone
        en: Phone
      value_type: uri
      preset: ecospheres_phone
      # TODO: ajouter un display_snippet pour l'hyperlien + suppression
      # du préfixe à l'affichage.
    # URL 
    # > vcard:hasURL
    # [+ GeoDCAT-AP]
    - field_name: url
      rdf_path:
        - vcard:hasURL
        - owl:Thing
      label: 
        fr: Site internet
        en: Website
      display_snippet: link.html
      value_type: uri
    # AFFILIATION {*}
    # > vcard:organization-name
    # [+ GeoDCAT-AP]
    - field_name: affiliation
      rdf_path:
        - vcard:organization-name
        - rdf:langString
      label: 
        fr: Appartient à
        en: Belongs to
      preset: multilingual_text
      value_type: literal
      translatable_values: True
    # ACRONYM {*}
    # > non exposé
    - field_name: acronym
      label: 
        fr: Sigle
        en: Abbreviations
      preset: multilingual_text
      value_type: literal
      translatable_values: True
    # COMMENT {*}
    - field_name: comment
      label: 
        fr: Commentaire
        en: Comment
      help_text: Description ou autre information relative à l'organisation.
      preset: multilingual_text
      value_type: literal
      translatable_values: True

# PUBLISHER [{}]
# > dct:publisher -> foaf:Organization
- field_name: publisher
  rdf_path:
    - dct:publisher
    - foaf:Organization
  label: 
    fr: Éditeur
    en: Publisher
  help_text: Organisme ou personne qui assure la publication des données.
  value_type: node
  tab: *tab_contacts
  repeating_subfields: &agent_fields
    # NAME {*}
    # > foaf:name
    # [+ DCAT-AP]
    - field_name: name
      rdf_path:
        - foaf:name
        - rdf:langString
      label: 
        fr: Nom
        en: Name
      preset: multilingual_text
      value_type: literal
      translatable_values: True
    # TYPE
    # > dct:type
    # [+ DCAT-AP]
    # - stockage et exposition sous forme d'URI
    - field_name: type
      rdf_path:
        - dct:type
        - skos:Concept
      label: 
        fr: Type
        en: Type
      display_snippet: ecospheres_vocabulary_uri.html
      value_type: uri
      known_values: require
      vocabularies:
        - adms_publisher_type
    # EMAIL
    # > foaf:mbox
    # [+ GeoDCAT-AP]
    # - stockage et exposition sous forme d'URI
    # - affichage sans préfixe 'mailto:'
    - field_name: email
      rdf_path:
        - foaf:mbox
        - owl:Thing
      label:
        fr: Courriel
        en: Mail
      value_type: uri
      preset: ecospheres_email
    # PHONE
    # > foaf:phone
    # [+ GeoDCAT-AP]
    # - stockage et exposition sous forme d'URI
    # - affichage sans préfixe 'tel:'
    - field_name: phone
      rdf_path:
        - foaf:phone
        - owl:Thing
      label:
        fr: Téléphone
        en: Phone
      value_type: uri
      preset: ecospheres_phone
      # TODO: ajouter un display_snippet pour l'hyperlien + suppression
      # du préfixe à l'affichage.
    # URL
    # > foaf:workplaceHomepage
    # [+ GeoDCAT-AP]
    # - stockage et exposition sous forme d'URI
    # - affichage de l'URL complète avec hyperlien
    - field_name: url
      rdf_path:
        - foaf:workplaceHomepage
        - foaf:Document
      label:
        fr: Site internet
        en: Website
      value_type: uri
      display_snippet: link.html
    # AFFILIATION {*}
    # > org:memberOf [-> org:Organization] / foaf:name
    # [+ GeoDCAT-AP]
    - field_name: affiliation
      rdf_path:
        - org:memberOf
        - org:Organization
        - foaf:name
        - rdf:langString
      label: 
        fr: Appartient à
        en: Belongs to
      preset: multilingual_text
      value_type: literal
      translatable_values: True
    # ACRONYM {*}
    # - non exposé pour l'heure
    # - information fournie par Dido uniquement
    # TODO: confirmer l'intérêt de l'afficher, considérant que les noms
    # d'organisation de Dido semblent spécifier le sigle entre parenthèses
    - field_name: acronym
      label: 
        fr: Sigle
        en: Abbreviations
      preset: multilingual_text
      value_type: literal
      translatable_values: True
    # COMMENT {*}
    # - non exposé pour l'heure
    # - information fournie par Dido uniquement
    - field_name: comment
      label: 
        fr: Commentaire
        en: Comment
      help_text: Description ou autre information relative à l'organisation.
      preset: multilingual_text
      value_type: literal
      translatable_values: True

# CREATOR [{}]
# > dct:creator -> foaf:Organization
- field_name: creator
  rdf_path:
    - dct:creator
    - foaf:Organization
  label:
    fr: Auteur
    en: Creator
  help_text: Principal responsable de la production des données.
  value_type: node
  tab: *tab_contacts
  repeating_subfields: *agent_fields

# RIGHTS_HOLDER [{}]
# dct:rightsHolder -> foaf:Organization
# [+ GeoDCAT-AP]
- field_name: rights_holder
  rdf_path:
    - dct:rights_holder
    - foaf:Organization
  label:
    fr: Propriétaires
    en: Holder
  repeating_label: Propriétaire
  help_text: Organisme ou personne qui détient des droits sur les données.
  value_type: node
  tab: *tab_contacts
  repeating_subfields: *agent_fields

# QUALIFIED_ATTRIBUTION [{}]
# > prov:qualifiedAttribution -> prov:Attribution
# [- DCAT-AP v2]
# il faudra prévoir un mapping entrant pour les propriétés
# geodcat:custodian, geodcat:distributor, geodcat:originator
# geodcat:principalInvestigator, geodcat:processor, 
# geodcat:resourceProvider et geodcat:user
- field_name: qualified_attribution
  rdf_path:
    - prov:qualifiedAttribution
    - prov:Attribution
  label: 
    fr: Autres organisations responsables
    en: Other responsible organization
  repeating_label: Autre organisation responsable
  help_text: >
    Organisme qui est intervenu ou exerce une responsabilité sur
    les données.
  value_type: node
  tab: *tab_contacts
  repeating_subfields:
    # HAD_ROLE {}
    # > dcat:hadRole
    - field_name: had_role
      rdf_path:
        - dcat:hadRole
        - dcat:Role
      label: 
        fr: Rôle
        en: Role
      multiple_values: True
      value_type: uri
      repeating_subfields:
        - field_name: uri
          label: 
            fr: URI
            en: URI
          value_type: uri
          known_values: require
          vocabularies:
            - inspire_role
          display_snippet: ecospheres_vocabulary_uri.html
    # AGENT [{}]
    # > prov:agent -> prov:Agent
    - field_name: agent
      rdf_path:
        - prov:agent
        - prov:Agent
      label: 
        fr: Organisation
        en: Organization
      value_type: node
      repeating_subfields:
        # NAME {*}
        # > foaf:givenName
        - field_name: name
          rdf_path:
            - foaf:givenName
            - rdf:langString
          label: 
            fr: Nom
            en: Name
          translatable_values: True
          preset: multilingual_text
          value_type: literal
        # EMAIL
        # > foaf:mbox 
        - field_name: email
          rdf_path:
            - foaf:mbox
            - owl:Thing
          label:
            fr: Courriel
            en: Mail
          value_type: uri
          preset: ecospheres_email
        # URI
        # > foaf:homePage
        - field_name: url
          rdf_path:
            - foaf:homePage
            - foaf:Document
          label: 
            fr: Site internet
            en: Website
          value_type: uri
          display_snippet: link.html

# ------- Relations -------
# IN_SERIES {}
# > dcat:inSeries
# [+ DCAT v3]
# - dct:isPartOf est également mappé vers ce champ
# - on stocke des identifiants sémantiques CKAN (champ "name" du dataset),
#   ou plus précisément des identifiants présumés.
# - pour l'affichage, on récupère le libellé (champ "title") du dataset
#   correspondant s'il existe, sinon la valeur est ignorée.
# - pour l'exposition DCAT, on récupère l'URI (champ "uri") du dataset
#   correspondant s'il existe, sinon la valeur est ignorée.
- field_name: in_series
  rdf_path:
    - dcat:inSeries
    - dcat:DatasetSeries
  label: 
    fr: Inclus dans les séries de données
    en: Included in data series
  help_text: Séries ou lots de données dont fait partie le jeu de données.
  value_type: node or uri
  repeating_subfields:
    # NAME
    - field_name: name
      label:
        fr: Identifiant CKAN de la série
        en: Data series slug
      value_type: literal
      display_snippet: null

# SERIES_MEMBER {}
# > dcat:seriesMember
# [+ DCAT v3]
# - si présent, on type le dataset comme dcat:DatasetSeries en plus de
#   dcat:Dataset (ce dernier pour assurer un minimum de rétro-compatibilité)
# - dct:hasPart est également mappé vers ce champ
# - pour l'affichage, on récupère le libellé (champ "title") du dataset
#   correspondant s'il existe, sinon la valeur est ignorée.
# - pour l'exposition DCAT, on récupère l'URI (champ "uri") du dataset
#   correspondant s'il existe, sinon la valeur est ignorée.
- field_name: series_member
  rdf_path:
    - dcat:seriesMember
    - dcat:Dataset
  label:
    fr: Jeux de données de la série
    en: Series datasets
  help_text: Jeux de données rattachés à la série ou lot de données.
  value_type: node or uri
  repeating_subfields:
    # NAME
    - field_name: name
      label:
        fr: Identifiant CKAN du jeu de données
        en: Series member slug
      value_type: literal
      display_snippet: null

# ------ Références ------

# LANDING_PAGE
# > dcat:landingPage -> foaf:Document
# pour l'URL de la fiche sur le catalogue source
- field_name: landing_page
  rdf_path:
    - dcat:landingPage
    - foaf:Document
  label:
    fr: Accès à la fiche sur le catalogue source
    en: Access to the record from source catalog
  display_snippet: link.html
  value_type: uri

# ATTRIBUTE_PAGE
# > foaf:page -> foaf:Document
# [+ DCAT-AP]
# pour le lien vers le catalogue d'attribut
- field_name: attributes_page
  rdf_path:
    - foaf:page
    - foaf:Document
  label:
    fr: Catalogue d'attributs
    en: Attributes Catalog
  help_text: Lien de la page où sont décrits les champs du jeu de données.
  display_snippet: link.html
  value_type: uri
  tab: *tab_docs

# PAGE [{}]
# > foaf:page -> foaf:Document
# [+ DCAT-AP]
# - pour la documentation au sens large
# - lorsque le catalogue source met à disposition des représentations
#   HTML, XML, RDF, etc. des métadonnées, elles sont autant que possible
#   mappées vers cette propriété
# - le champ "uri" correspond à l'objet du triplet <uri> foaf:page <uri>,
#   s'il n'est pas défini, l'exposition utilise un noeud anonyme
- field_name: page
  rdf_path:
    - foaf:page
    - foaf:Document
  label:
    fr:  Documentation
    en:  Documentation
  value_type: node or uri
  tab: *tab_docs
  repeating_subfields:
    # URI
    - field_name: uri
      label: 
        fr: URL
        en: URL
      display_snippet: null
      value_type: uri
    # TITLE {*}
    # > dct:title
    # [+ GeoDCAT-AP]
    - field_name: title
      rdf_path:
        - dct:title
        - rdf:langString
      label: 
        fr: Titre
        en: Title
      preset: multilingual_text
      value_type: literal
      translatable_values: True
    # DESCRIPTION {*}
    # > dct:description
    # [+ GeoDCAT-AP]
    - field_name: description
      rdf_path:
        - dct:description
        - rdf:langString
      label: 
        fr: Description
        en: Description
      preset: multilingual_markdown
      value_type: literal
      translatable_values: True
    # URL 
    # > dcat:accessURL -> rdfs:Resource
    # [X]
    # hors standards DCAT
    - field_name: url
      rdf_path:
        - dcat:accessURL
        - rdfs:Resource
      label: 
        fr: URL d'accès
        en: Access URL
      help_text: URL d'accès à la ressource.
      display_snippet: url_access.html
      value_type: uri
      multiple_values: True
    # MODIFIED
    # > dct:modified
    # [X]
    # disponible dans Dido, hors standards DCAT
    - field_name: modified
      rdf_path:
        - dct:modified
        - xsd:date
      label:
        fr: Date de modification
        en: Modified date
      preset: ecospheres_date_or_datetime
      help_text: Date de dernière modification du document.
      value_type: literal
    # CREATED
    # > dct:created
    # [X]
    # disponible dans Dido, hors standards DCAT
    - field_name: created
      rdf_path:
        - dct:created
        - xsd:date
      label: 
        fr: Date de création
        en: Creation Date
      preset: ecospheres_date_or_datetime
      help_text: Date de création du document.
      value_type: literal
    # ISSUED
    # > dct:issued
    # [X]
    # disponible dans Dido, hors standards DCAT
    - field_name: issued
      rdf_path:
        - dct:issued
        - xsd:date
      label: 
        fr: Date de publication
        en: Issued date 
      preset: ecospheres_date_or_datetime
      help_text: Date de publication du document.
      value_type: literal
    
# # ------ Thèmes et mots clés ------

# CATEGORY []
# > dcat:theme
# - thèmes (et sous-thèmes) de la nomenclature du guichet
# - déduit de "theme", "subject" et "free_tag" lors du moissonnage
# - stockage sous forme d'une liste d'URI (appartenant au registre
#   du guichet)
- field_name: category
  rdf_path:
    - dcat:theme
    - skos:Concept
  label: 
    fr: Thèmes
    en: Topic
  multiple_values: True
  value_type: uri
  tab: *tab_details
  repeating_subfields:
    - field_name: uri
      label: 
        fr: URI
        en: URI
      value_type: uri
      known_values: require
      vocabularies:
        - ecospheres_theme
      display_snippet: ecospheres_vocabulary_uri.html

# THEME {}
# > dcat:theme
# - pour les nomemclatures externes, notamment celle de la commission
#   européenne et la nomenclature INSPIRE
# - mapper dct:subject vers cette propriété (utilisé dans GeoDCAT-AP v2
#   pour les catégories ISO)
# - stockage sous la forme d'une liste d'URI
- field_name: theme
  rdf_path:
    - dcat:theme
    - skos:Concept
  label:
    fr: Autres thèmes
    en: Other theme
  multiple_values: True
  value_type: uri
  repeating_subfields:
    - field_name: uri
      display_snippet: ecospheres_vocabulary_uri.html
      label: 
        fr: URI
        en: URI
      value_type: uri
      known_values: require
      vocabularies:
        - inspire_theme
        - inspire_topic_category
        - eu_theme

# FREE_TAGS [{*}]
# {"en": ["big", "large"], "fr": ["grande"]}
# > dcat:keyword
# - pour les mots-clés libres
- field_name: free_tags
  rdf_path:
    - dcat:keyword
    - rdf:langString
  label: 
    fr: Mots-clés
    en: Keywords
  help_text: Mots-clés libres.
  translatable_values: True
  multiple_values: True
  value_type: literal
  preset: ecospheres_multilingual_list
  tag_validators: remove_whitespace
  tab: *tab_details

# # ------ Métadonnées sur les métadonnées ------

# CATALOG_RECORD
# > foaf:isPrimaryTopicOf [-> dcat:CatalogRecord]
- field_name: catalog_record
  rdf_path:
    - foaf:isPrimaryTopicOf
    - dcat:CatalogRecord
  label:
    fr: Fiche de métadonnées source
    en: Source record
  flatten_subfields: True
  value_type: node
  tab: *tab_catalog
  repeating_subfields:

    # RECORD_IN_CATALOG [{}]
    # > dcat:inCatalog -> dcat:Catalog
    - field_name: record_in_catalog
      rdf_path:
        - dcat:inCatalog
        - dcat:Catalog
      label:
        fr: Catalogue source
        en: Source catalog
      value_type: node
      repeating_subfields:
        # TITLE {*}
        # > dct:title
        - field_name: title
          rdf_path:
            - dct:title
            - rdf:langString
          label:
            fr: Nom
            en: Name
          preset: multilingual_text
          value_type: literal
          translatable_values: True
        # HOMEPAGE
        # > foaf:homepage
        - field_name: homepage
          rdf_path:
            - foaf:homepage
            - foaf:Document
          label:
            fr: URL
            en: URL
          value_type: uri
          display_snippet: link.html

    # RECORD IDENTIFIER 
    # > dct:identifier
    - field_name: record_identifier
      rdf_path:
        - dct:identifier
        - xsd:string
      label:
        fr: Identifiant de la fiche de métadonnées
        en: Metadata record identifier
      display_snippet: null
      help_text: Identifiant de la fiche de métadonnées.
      value_type: literal
      tab: *tab_catalog

    # RECORD MODIFIED
    # > dct:modified
    - field_name: record_modified
      rdf_path:
        - dct:modified
        - xsd:dateTime
      label: 
        fr: Date de modification de la fiche
        en : Record modified
      preset: datetime_tz
      help_text: Date de dernière modification des métadonnées dans le catalogue d'origine.
      value_type: literal

    # RECORD HARVESTED
    # - hors DCAT, affiché dans CKAN mais non exposé
    - field_name: record_harvested
      label: 
        fr: Date de moissonnage de la fiche
        en : Harvest date
      preset: datetime_tz
      help_text: Date du dernier moissonnage de la fiche de métadonnées.
      value_type: literal

    # RECORD LANGUAGE {}
    # > dct:language
    # [+ DCAT-AP]
    # - stockage et exposition sous la forme d'une liste d'URI
    # - affichage des étiquettes, obtenues en interrogeant les URI,
    #   qui sont présumées pointer sur un registre RDF.
    - field_name: record_language
      rdf_path:
        - dct:language
        - dct:LinguisticSystem
      label: 
        fr: Langues des métadonnées
        en: Metadata languages
      help_text: Langues de rédaction des métadonnées.
      multiple_values: True
      value_type: uri
      repeating_subfields:
        # URI
        - field_name: uri
          label: 
            fr: URI
            en: URI
          value_type: uri
          known_values: require
          vocabularies:
            - eu_language
          display_snippet: ecospheres_vocabulary_uri.html

    # RECORD CONTACT_POINT [{}]
    # > dcat:contactPoint -> vcard:Kind
    - field_name: record_contact_point
      rdf_path:
        - dcat:contactPoint
        - vcard:Kind
      label:
        fr: Points de contact pour les métadonnées
        en: Metadata contact point
      repeating_label: Point de contact
      help_text: Entité à contacter pour obtenir des informations sur les métadonnées.
      value_type: node
      repeating_subfields: *contact_fields

# # ------ Couverture spatiale ------

# BBOX
# > dct:spatial [-> dct:Location] / dcat:bbox
# pour l'emprise du jeu de données
# - stockage et exposition sous forme de littéral GML ou WKT, comme
#   il convient pour cette propriété
# - calculé à partir de "spatial" pour les métadonnées INSPIRE
- field_name: bbox
  rdf_path:
    - dct:spatial
    - dct:Location
    - dcat:bbox
    - gsp:wktLiteral
  label: 
    fr: Rectangle d'emprise
    en: Bounding box
  display_snippet: null
  value_type: literal

# SPATIAL_COVERAGE [{}]
# > dct:spatial -> dct:Location
# - pour les territoires sur lesquels portent les données
# - le champ "uri" correspond à l'objet du triplet <...> dct:spatial <uri>,
#   s'il n'est pas défini, l'exposition utilise un noeud anonyme
#   de classe dct:Location 
- field_name: spatial_coverage
  rdf_path:
    - dct:spatial
    - dct:Location
  label:
    fr: Couverture géographique
    en: Spatial coverage
  value_type: node or uri
  tab: *tab_details
  multiple_values: True
  repeating_subfields:
    # URI
    - field_name: uri
      label: 
        fr: URL
        en: URL
      value_type: uri
      known_values: require
      vocabularies:
        - eu_administrative_territory_unit
        - insee_official_geographic_code
        - insee_individual_territories
      display_snippet: ecospheres_vocabulary_uri.html
    # IN_SCHEME
    # > skos:inScheme
    # [+ GeoDCAT-AP]
    - field_name: in_scheme
      rdf_path:
        - skos:inScheme
        - skos:ConceptScheme
      label: 
        fr: Index géographique
        en: Gazetteer
      help_text: Type de lieu, index de référence pour l'identifiant (commune, département...).
      value_type: uri
      known_values: require
      vocabularies:
        - insee_gazetteer
      display_snippet: ecospheres_vocabulary_uri.html
    # IDENTIFIER
    # > dct:identifier
    # [+ GeoDCAT-AP]
    - field_name: identifier
      rdf_path:
        - dct:identifier
        - xsd:string
      label: 
        fr: Code géographique
        en: Geographic identifier
      help_text: Code du département, code INSEE de la commune, etc.
      value_type: literal
    # LABEL {*}
    # > skos:prefLabel
    # [+ GeoDCAT-AP]
    - field_name: label
      rdf_path:
        - skos:prefLabel
        - rdf:langString
      label:
        fr:  Libellé
        en:  Geographic name
      help_text: Dénomination explicite du lieu.
      translatable_values: True
      preset: multilingual_text
      value_type: literal

# SPATIAL
# - utilisé par ckanext-spatial pour la prévisualisation cartographique
# - non exposé en DCAT
# - stockage sous la forme d'un dump GeoJSON (cf.
#   http://docs.ckan.org/projects/ckanext-spatial/en/latest/spatial-search.html#geo-indexing-your-datasets)
# - calculé à partir de "bbox" (propriété de "spatial_coverage") pour 
#   les métadonnées DCAT
- field_name: spatial
  label: 
    fr: Rectangle d'emprise
    en: Boundary rectangle
  display_snippet: null
  value_type: literal

# TERRITORY {}
# - non repris dans l'export DCAT (hormis pour les
#   informations mappées depuis la propriété "spatial")
# - utilisé uniquement pour le filtrage par territoire
# - déduit de "spatial" si possible, à défaut du territoire de
#   compétence de l'organisation
# - stockage sous la forme d'une liste d'URI
- field_name: territory
  label: 
    fr: Territoires
    en: Territory
  display_snippet: null
  help_text: Divisions administratives (régions, départements...) présumées couvertes par les données.
  multiple_values: True
  value_type: uri
  repeating_subfields:
    # URI
    - field_name: uri
      label: 
        fr: URI
        en: URI
      value_type: uri
      known_values: require
      vocabularies:
        - ecospheres_territory

# TERRITORY_FULL {}
# - reprend la liste de "territory" en y ajoutant les
#   territoires qui contiennent ces territoires (par ex la région
#   d'un département)
# - stockage sous la forme d'une liste d'URI
- field_name: territory_full
  label: 
    fr: Territoires (inclusif)
    en: Territory (inclusif)
  display_snippet: null
  help_text: Divisions administratives (régions, départements...) incluant les données.
  multiple_values: True
  value_type: uri
  repeating_subfields:
    # URI
    - field_name: uri
      label: 
        fr: URI
        en: URI
      value_type: uri
      known_values: require
      vocabularies:
        - ecospheres_territory

# # ------- Etc. ------

# ACCESS_RIGHTS [{}]
# > dct:accessRights -> dct:RightsStatement
# - le champ "uri" correspond à l'objet du triplet
#   <uri> dct:accessRights <uri>, s'il n'est pas
#   défini, l'exposition utilise un noeud anonyme de classe
#   dct:RightsStatement 
- tab: *tab_details
  field_name: access_rights
  rdf_path:
    - dct:accessRights
    - dct:RightsStatement
  label: 
    fr: Conditions d'accès
    en: Access conditions
  help_text: Contraintes réglementaires limitant l'accès au jeu de données.
  value_type: node or uri
  repeating_subfields: &access_rights_fields
    # URI
    - field_name: uri
      label: 
        fr: URL
        en: URL
      value_type: uri
      known_values: require
      vocabularies:
        - inspire_limitation_on_public_access
        - eu_access_right
      display_snippet: ecospheres_vocabulary_uri.html
    # LABEL {*}
    # > rdfs:label
    # [+ GeoDCAT-AP]
    - field_name: label
      rdf_path:
        - rdfs:label
        - rdf:langString
      label: 
        fr: Mention
        en: Mention
      help_text: >
        Description des contraintes réglementaires qui limitent l'accès
        aux données et des modalités pratiques pour les obtenir.
      translatable_values: True
      preset: multilingual_text
      value_type: literal

# RESTRICTED_ACCESS
# - non exposé dans l'export DCAT, utilisé pour l'élément
#   Données ouvertes / Accès restreint
# - booléen déduit de access_rights
- field_name: restricted_access
  label:
    fr: Donnée à accès restreint
    en: Restricted access
  value_type: literal

# RIGHTS {*}
# > dct:rights [-> dct:RightsStatement] / rdfs:label
- tab: *tab_details
  field_name: rights
  rdf_path:
    - dct:rights
    - dct:RightsStatement
    - rdfs:label
    - rdf:langString
  label:
    fr:  Autre mention juridique
    en:  Rights
  help_text: > 
    Autre mention à caractères juridique, par exemple rappelant les
    droits de propriété intellectuelle sur les données, à faire apparaître
    en cas de réutilisation.
  preset: ecospheres_multiple_multilingual_markdown
  tag_validators: remove_whitespace
  translatable_values: True
  multiple_values: True
  value_type: literal

# CRS {}
# > dct:conformsTo
# - pour les référentiels de coordonnées
# - stockage et exposition sous forme d'une liste d'URI
# - affichage de l'étiquette, récupérée en interrogeant l'URI
- field_name: crs
  rdf_path:
    - dct:conformsTo
    - dct:Standard
  label: 
    fr: Référentiels de coordonnées
    en: Coordinate Reference System
  multiple_values: True
  value_type: uri
  tab: *tab_details
  repeating_subfields:
    # URI
    - field_name: uri
      label: 
        fr: URI
        en: URI
      value_type: uri
      known_values: require
      vocabularies:
        - ogc_epsg
        - ign_crs
      display_snippet: ecospheres_vocabulary_uri.html

# CONFORMS_TO [{}]
# > dct:conformsTo -> dct:Standard
# - pour les autres standards
# - le champ "uri" correspond à l'objet du triplet
#   <uri> dct:conformsTo <uri>. S'il n'est pas
#   défini, l'exposition utilise un noeud anonyme de classe
#   dct:Standard 
- field_name: conforms_to
  rdf_path:
    - dct:conformsTo
    - dct:Standard
  label: 
    fr: Standard
    en: Standard
  help_text: Standard, schéma, etc. auquel se conforment les données.
  value_type: node or uri
  tab: *tab_details
  display_snippet: conforms_to.html
  repeating_subfields: &standard_fields
    # URI
    - field_name: uri
      label: 
        fr: URL
        en: URL
      value_type: uri
      known_values: allow
      vocabularies:
        - plume_data_service_standard
        # - ecospheres_data_standard
      display_snippet: ecospheres_vocabulary_linked_uri.html
    # TITLE {*}
    # > dct:title
    # [+ GeoDCAT-AP]
    - field_name: title
      rdf_path:
        - dct:title
        - rdf:langString
      label: 
        fr: Libellé
        en: Label
      value_type: literal
      preset: multilingual_text
      translatable_values: True

# ACCRUAL_PERIODICITY
# > dct:accrualPeriodicity
# - stockage et exposition sous forme d'URI
# - affichage de l'étiquette récupérée par interrogation de l'URI
- field_name: accrual_periodicity
  rdf_path:
    - dct:accrualPeriodicity
    - dct:Frequency
  label:
    fr:  Fréquence de mise à jour
    en:  Update frequency
  value_type: uri
  known_values: require
  vocabularies:
    - inspire_maintenance_frequency
    - eu_frequency
  display_snippet: ecospheres_vocabulary_uri.html
  tab: *tab_details

# STATUS
# > adms:status
# [+ DCAT v3]
# - stockage et exposition sous forme d'URI
# - affichage de l'étiquette récupérée par interrogation de l'URI
- field_name: status
  rdf_path:
    - adms:status
    - skos:Concept
  label:
    fr:  Maturité
    en:  Dataset status
  value_type: uri
  known_values: require
  vocabularies:
    - eu_dataset_status
    - adms_status
    - iso19139_progress_code
  display_snippet: ecospheres_vocabulary_uri.html
  tab: *tab_details

# LANGUAGE []
# > dct:language
# - stockage et exposition sous forme d'une liste d'URI
# - affichage des étiquettes récupérées par interrogation des URI
- field_name: language
  rdf_path:
    - dct:language
    - dct:LinguisticSystem
  label: 
    fr: Langues des données
    en: Data language
  multiple_values: True
  value_type: uri
  tab: *tab_details
  repeating_subfields:
    # URI
    - field_name: uri
      label: 
        fr: URI
        en: URI
      value_type: uri
      known_values: require
      vocabularies:
        - eu_language
      display_snippet: ecospheres_vocabulary_uri.html

# PROVENANCE [{*}]
# > dct:provenance [-> dct:ProvenanceStatement] / rdfs:label
# [+ DCAT-AP]
# TODO: meilleur preset, qui respecte la multiplicité,
# mais reconnaît le Markdown
- field_name: provenance
  rdf_path:
    - dct:provenance
    - dct:ProvenanceStatement
    - rdfs:label
    - rdf:langString
  label: 
    fr: Généalogie
    en: Genealogy
  help_text: Informations sur les sources et méthodes de production des données.
  value_type: literal
  multiple_values: True
  translatable_values: True
  preset: ecospheres_multiple_multilingual_markdown
  tag_validators: remove_whitespace
  tab: *tab_details

# VERSION
# > owl:versionInfo
- field_name: version
  rdf_path:
    - owl:versionInfo
    - xsd:string
  label: 
    fr: Version
    en: Version
  help_text: Version ou millésime du jeu de données.
  value_type: literal
  tab: *tab_details

# VERSION_NOTES {*}
# > adms:versionNotes
- field_name: version_notes
  rdf_path:
    - adms:versionNotes
    - rdf:langString
  label: 
    fr: Notes de version
    en: Release Notes
  preset: multilingual_markdown
  help_text: Différences entre la version courante des données et les versions antérieures.
  translatable_values: True
  value_type: literal
  tab: *tab_details

# TEMPORAL_RESOLUTION
# > dcat:temporalResolution
# - stockage et exposition sous forme standardisée (ex: 'P2HT30M' pour 2h30)
- field_name: temporal_resolution
  rdf_path:
    - dcat:temporalResolution
    - xsd:duration
  label: 
    fr: Résolution temporelle
    en: Temporal resolution
  help_text: Plus petit pas de temps significatif dans le contexte du jeu de données.
  value_type: literal
  tab: *tab_details
  # TODO: Ajouter un display_snippet capable d'afficher
  # des durées lisibles à partir de la forme standardisée

# SPATIAL_RESOLUTION
# > dcat:spatialResolutionInMeters
- field_name: spatial_resolution
  rdf_path:
      - dcat:spatialResolutionInMeters
      - xsd:decimal
  label: 
    fr: Résolution spatiale en mètres
    en: Spatial resolution in meters
  help_text: Plus petite distance significative dans le contexte du jeu de données, exprimée en mètres.
  value_type: literal
  tab: *tab_details

# EQUIVALENT_SCALE
# non exposé, permet uniquement de conserver
# cette information présente dans les métadonnées INSPIRE
# et sur la base de laquelle "spatial_resolution" est
# calculé
- field_name: equivalent_scale
  label: 
    fr: Échelle équivalente
    en: Equivalent scale
  value_type: literal
  display_snippet: null

# # ------ Champs CKAN hors DCAT ------

# LICENSE
# calculé à partir des champs "license" des ressources
- field_name: license
  label:
    fr: Licence
    en: License
  display_snippet: null
  value_type: uri
  display_snippet: ecospheres_vocabulary_uri.html
  vocabularies:
    - eu_licence
    - spdx_license

# GRAPHIC_PREVIEW
# URL d'une image illustrant les données
- field_name: graphic_preview
  label: 
    fr: Illustration
    en: Illustration
  display_snippet: image.html
  value_type: uri

# # ------ Export des métadonnées ------

# AS_INSPIRE_XML
# non exposé dans l'export DCAT
- field_name: as_inspire_xml
  label:
    fr: Vue XML INSPIRE des métadonnées
    en: Metadata as INSPIRE conforming XML
  display_snippet: link.html
  value_type: uri
  tab: *tab_catalog

# AS_DCAT_RDF
# non exposé dans l'export DCAT
- field_name: as_dcat_rdf
  label:
    fr: Vue DCAT des métadonnées
    en: Metadata as DCAT conforming RDF file
  value_type: node
  tab: *tab_catalog
  repeating_subfields:
    # FORMAT
    - field_name: format
      label: 
        fr: Format
        en: Format
      value_type: node or uri
      repeating_subfields: &format_fields
        # URI
        - field_name: uri
          label:
            fr:  URI
            en:  URI
          value_type: uri
          known_values: require
          vocabularies:
            - eu_file_type
            - iana_media_type
          display_snippet: ecospheres_vocabulary_uri.html
        # LABEL
        # > rdfs:label
        # [+ GeoDCAT-AP]
        - field_name: label
          rdf_path:
            - rdfs:label
            - rdf:langString
          label:
            fr: Nom
            en: Name
          value_type: literal
    # DOWNLOAD_URI
    - field_name: download_url
      label:
        fr:  Téléchargement
        en:  Download URL
      help_text: URL de téléchargement direct du fichier.
      display_snippet: link.html
      value_type: uri

# CKAN_API_SHOW
# non exposé dans l'export DCAT
- field_name: ckan_api_show
  label:
    fr: Vue des métadonnées via l'API CKAN
    en: Get metadata through CKAN API
  display_snippet: link.html
  value_type: uri
  validators: ecospheres_ckan_api_show
  tab: *tab_catalog

# ------------------------------------------------------------------------
# ------------------------------ RESSOURCES ------------------------------
# ------------------------------------------------------------------------
# -> dcat:Distribution

resource_fields:

# URI
# fournit l'URI de la dcat:Distribution pour l'exposition DCAT
- field_name: uri
  label: 
    fr: URI de la ressource
    en: Resource URI
  display_snippet: null
  value_type: uri

# URL 
# > dcat:accessURL
- field_name: url
  rdf_path:
    - dcat:accessURL
    - rdfs:Resource
  label: 
    fr: URL d'accès
    en: Access URL
  help_text: URL d'accès à la ressource.
  preset: url
  display_snippet: url_access.html
  value_type: uri

# DOWNLOAD_URL 
# > dcat:downloadURL
- field_name: download_url
  rdf_path:
    - dcat:downloadURL
    - rdfs:Resource
  label:
    fr:  Téléchargement
    en:  Download URL
  help_text: URL de téléchargement direct du fichier, dans le cas d'une ressource téléchargeable.
  preset: url
  value_type: uri

# TITLE {*}
# > dct:title
- field_name: name
  rdf_path:
    - dct:title
    - rdf:langString
  label:
    fr: Nom
    en: Name
  preset: multilingual_text
  translatable_values: True
  value_type: literal

# DESCRIPTION {*}
# > dct:description
- field_name: description
  rdf_path:
    - dct:description
    - rdf:langString
  label: 
    fr: Description
    en: Description
  preset: multilingual_markdown
  translatable_values: True
  value_type: literal

# MEDIA_TYPE [{}]
# > dcat:mediaType -> dct:MediaType
- field_name: media_type
  rdf_path:
    - dcat:mediaType
    - dct:MediaType
  label: 
    fr: Format
    en: Format
  help_text: >
    URI du registre de l'IANA représentant le type de média de la ressource.
  value_type: uri
  known_values: require
  vocabularies:
    - iana_media_type
  display_snippet: ecospheres_vocabulary_uri.html

# OTHER_FORMAT [{}]
# > dct:format -> dct:MediaTypeOrExtent
- field_name: other_format
  rdf_path:
    - dct:format
    - dct:MediaTypeOrExtent
  label: 
    fr: Format
    en: Format
  value_type: node or uri
  repeating_subfields: *format_fields

# FORMAT []
# on mappe dans le champ "format" natif les étiquettes
# des propriétés "media_type", "other_format" et 
# "service_conforms_to" (dans cet ordre et en s'arrêtant
# dès qu'on obtient une valeur)
- field_name: format
  label: 
    fr: Format
    en: Format
  value_type: literal

# SERVICE_CONFORMS_TO [{}]
# > dcat:accessService [-> dcat:DataService] / dct:conformsTo
# - pour spécifier le protocole/standard auquel se conforme le
#   service qui met à disposition la ressource, le cas échéant
- field_name: service_conforms_to
  rdf_path:
    - dcat:accessService
    - dcat:DataService
    - dct:conformsTo
    - dct:Standard
  label: 
    fr: Service
    en: Service
  help_text: >
    Standard, protocole, référentiel de coordonnées, etc. auquel se conforme
    le service qui met à disposition la ressource.
  value_type: node or uri
  display_snippet: service_conforms_to.html
  repeating_subfields: *standard_fields

# ACCESS_RIGHTS [{}]
# > dct:accessRights -> dct:RightsStatement
# - le champ "uri" correspond à l'objet du triplet
#   <uri> dct:accessRights <uri>, s'il n'est pas
#   défini, l'exposition utilise un noeud anonyme de classe
#   dct:RightsStatement 
- field_name: access_rights
  rdf_path:
    - dct:accessRights
    - dct:RightsStatement
  label: 
    fr: Conditions d'accès
    en: Access conditions
  help_text: Contraintes réglementaires limitant l'accès au jeu de données.
  value_type: node or uri
  repeating_subfields: *access_rights_fields

# RIGHTS {*}
# > dct:rights [-> dct:RightsStatement] / rdfs:label
- field_name: rights
  rdf_path:
    - dct:rights
    - dct:RightsStatement
    - rdfs:label
    - rdf:langString
  label:
    fr:  Autre mention juridique
    en:  Rights
  help_text: > 
    Autre mention à caractères juridique, par exemple rappelant les
    droits de propriété intellectuelle sur les données, à faire apparaître
    en cas de réutilisation.
  preset: ecospheres_multiple_multilingual_markdown
  tag_validators: remove_whitespace
  translatable_values: True
  multiple_values: True
  value_type: literal

# LICENSE [{}]
# > dct:license -> dct:LicenseDocument
# - le champ "uri" correspond à l'objet du triplet <...> dct:license <uri>,
#   s'il n'est pas défini, l'exposition utilise un noeud anonyme
#   de classe dct:LicenseDocument 
- field_name: license
  rdf_path:
    - dct:license
    - dct:LicenseDocument
  label: 
    fr: Licence
    en: Licence
  help_text: Conditions d'utilisation de la ressource.
  value_type: node or uri
  repeating_subfields:
    # URI
    - field_name: uri
      label:
        fr: URI
        en: URI
      value_type: uri
      known_values: require
      vocabularies:
        - eu_licence
        - spdx_license
      display_snippet: ecospheres_vocabulary_linked_uri.html
    # TYPE []
    # > dct:type
    # [+ DCAT-AP]
    - field_name: type
      rdf_path:
        - dct:type
        - skos:Concept
      label: 
        fr: Type
        en: Type
      help_text: Caractéristiques de la licence.
      multiple_values: True
      value_type: uri
      known_values: require
      vocabularies:
        - adms_licence_type
      display_snippet: ecospheres_vocabulary_uri.html
    # LABEL {*}
    # > rdfs:label
    # [+ GeoDCAT-AP]
    - field_name: label
      rdf_path:
        - rdfs:label
        - rdf:langString
      label: 
        fr: Termes
        en: Terms
      help_text: Termes de la licence.
      preset: multilingual_markdown
      value_type: literal
      translatable_values: True

# ISSUED
# > dct:issued
- field_name: resource_issued
  rdf_path:
    - dct:issued
    - xsd:date
  label:
    fr: Date de publication
    en: Issued Date
  preset: ecospheres_date_or_datetime
  help_text: Date de publication de la ressource.
  value_type: literal

